# spatial_scERA

### Goal
We developped the spatial_scERA method to predict the spatial activity of _Drosophila melanogaster_ enhancers during embryogenesis, thanks to scRNA-seq and novoSpaRc tools.
Our first experiment caracterised the spatial activity of 25 enhancers in a stage 6 embryo.
This git repository contains all the scripts used to carry out the analyses and to generate the figures found in the paper: [biorXiv][biorXiv]

[biorXiv]: https://doi.org/10.1101/2024.10.02.616294

---

### Architecture
The repository is composed of several folders. Aditional information are available in other READMEs.
- **data**: This folder stores the sequencing data, custom genome, scRNA-seq matrix and all the intermediate files generated by the different scripts. Path to download data is available in the dedicated README file.
- **envs**: contains the _conda yml_ files and _Renv_ files in order to load and use the same packages/libraries as well as the specific versions used in the analyses. 
- **preprocessing**: This folder contains the scripts used to generate the preprocessed data (mapping scRNA-seq datasets with cellranger and trimming PCR datasets with cutadapt).  
- **python_analyses**: This folder is separated in two.
  - **01_trimming_PCR** has the necessary scripts to list all the enhancer present in the cells from the PCR data.
  - **02_novosparc_scripts** has all the scripts where novoSpaRc is involved. The **home made functions** coded to improve novoSpaRc are in the _home_functions.py_ file. More details on each scripts can be found in the dedicated README
- **R_analyses**: contains all the scripts made in R. More info on the scripts themselves can be found in the dedicated README


---

### Global pipeline
1. Load the processed data at E-MTAB-14447 (scRNA-seq), and E-MTAB-14445 (targeted PCR amplification) + the custome genome with the doi: 10.5281/zenodo.13711749 if you want to run cellranger
2. Run the seurat_initial_analysis.R to analyse the scRNA-seq datasets
3. Run the trimming_PCR script to generate the cell/enhancer tables from PCR data
4. Run the novosparc_initial_analysis notebook to generate the predictions of each enhancer spatial activity.

### Note
The other scripts are usefull to generate images or perform supplementary analysis. You can learn more in the dedicated READMEs and in the scripts' commentaries.

---


## Contributing

Found a typo in the documentation? Interested in adding a feature or
[fixing a bug][issues]? Then by all means [submit an issue][new-issue] or take a
stab at submitting a [pull request][using-pull-requests].

[issues]: https://gitbio.ens-lyon.fr/igfl/enriquez/myo_d/clustering_analysis/issues
[new-issue]: https://gitbio.ens-lyon.fr/igfl/enriquez/myo_d/clustering_analysis/issues/new
[using-pull-requests]: https://help.github.com/articles/using-pull-requests/

### Pull Requests

When submitting a pull request:

1. Clone the repo.
2. Create a branch off of `master` and give it a meaningful name (e.g.
   `my-awesome-new-feature`) and describe the feature or fix.
3. Open a pull request on GitLab.

---

## License

This project is licensed under the CeCiLL License - see the [LICENSE](LICENSE) file for details.

---

## Project status

Ongoing.